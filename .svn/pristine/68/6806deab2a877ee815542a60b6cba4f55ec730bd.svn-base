function getTwitterFeed()
{

}

function getInstagramFeed()
{

}

function sizeOffsetBlock()
{
	var possOffset = $('#navigation').offset().top - $(window).scrollTop()
	var offset = $('#navigation').height() + ( possOffset > 0 ? possOffset : 0);
	$('.offset-block').height(offset);
	$('.sidebar-slide .inner').height($(window).height() - offset - 10);
}

$(document).ready(function()
{
	sizeOffsetBlock();
});

$(window).scroll(function(){
	sizeOffsetBlock();
});

$(window).resize(function(){
	sizeOffsetBlock();
});

// @foreach($fbFeed->data as $feedItem)
// 	<div class="fb-entry">
// 		<?php 
// 			$itemId = explode('_', $feedItem->id);
// 			$itemId = $itemId[1];
// 		?>
// 		<a href="https://www.facebook.com/StudioGood/posts/{{$itemId}}" target="_blank">
// 			@if(isset($feedItem->picture))
// 				<img class="fb-image" src="{{$feedItem->picture}}" />
// 			@endif
// 			@if(isset($feedItem->message))
// 				<div class="fb-message">{{$feedItem->message}}</div>
// 			@endif
// 		</a>
// 	</div>
// 	<div class="fb-divider"></div>
// @endforeach

function getFacebook()
{

	var html = $('#facebook-slide'), entry, link, image, message, itemId, divider;
	$.ajax(
		'/social/facebook',
		{
			success: function(response)
			{
				response = JSON.parse(response);
				response = response.data;

				html.find('.loading-gif').remove();

				response.forEach(function(post)
				{
					entry = $('<div class="social-entry"></div>');

					itemId = post.id.split('_');
					itemId = itemId[1];
					
					link = $('<a href="https://www.facebook.com/StudioGood/posts/' + itemId + '" target="_blank"></a>');

					if(typeof post.picture !== "undefined")
					{
						image = $('<img class="social-image" src="' + post.picture + '" />');
					} 
					else
					{
						image = '';
					}

					if(typeof post.message !== "undefined")
					{
						message = $('<div class="social-message"></div>');
						message.text(post.message);
					}
					else
					{
						message = '';
					}

					link.append(image).append(message);

					entry.append(link);

					divider = $('<div class="divider"></div>');

					html.append(entry).append(divider);

				});

				if($('#facebook-tab').hasClass('active'))
				{
					$('.sidebar-slide .inner').html($('#facebook-slide').html());
				}

			},
			error: function(response)
			{
				console.log(response);
			}
		}
	);
}

function getTwitter()
{
	var html = $('#twitter-slide'), entry, link, image, user, message, itemId, divider;
	$.ajax(
		'/social/twitter',
		{
			success: function(response)
			{
				response = JSON.parse(response);

				console.log(response);

				html.find('.loading-gif').remove();

				response.forEach(function(tweet){
					entry = $('<div class="social-entry"></div>');
					link = $('<a href="http://twitter.com/' + tweet.user.screen_name + '/status/' + tweet.id_str + '" target="_blank"></a>');
					if(typeof tweet.entities !== "undefined" && typeof tweet.entities.media !== "undefined" && tweet.entities.media.length > 0)
					{
						image = $('<img class="social-image" src="' + tweet.entities.media[0].media_url_https + '" />');
					}
					else
					{
						image = $('<img class="social-image" src="/img/logo-placeholder.png" />');	
					}
					message = $('<div class="social-message"></div>');
					message.text(tweet.text);

					divider = $('<div class="divider"></div>');

					link.append(image).append(message);

					entry.append(link);

					html.append(entry).append(divider);
					
				});

				if($('#twitter-tab').hasClass('active'))
				{
					$('.sidebar-slide .inner').html($('#twitter-slide').html());
				}
			},
			error: function(response)
			{
				console.log(response);
			}
		}
	)
}

$(document).ready(function(){
	getFacebook();
	getTwitter();
});

$('.sidebar-tab').on('click', function(){
    $('#social-nav').addClass('open');
    $('.sidebar-tab').removeClass('active');
    $(this).addClass('active');

    $('.sidebar-slide .inner').html($($(this).attr('data-target')).html());
});

$('html').on('click', function(evt){
    if($('#social-nav').hasClass('open'))
    {
        if($(evt.target).closest('#social-nav').length === 0)
        {
            $('#social-nav').removeClass('open');
            $('.sidebar-tab').removeClass('active');
        }
    }
});